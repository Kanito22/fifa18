{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'polls/style.css' %}" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

{% if user.is_authenticated %}
    <h3>Bienvenido {{ user.username }}!</h3>

    <p><a href="{% url 'logout' %}">logout</a></p>
    
    <div style="overflow-x:auto;">
    <table>
        <caption>Ranking</caption>
    <tr>
        <th>Usuario</th>
        <th>Puntos</th>
    </tr>
    {% for key, value in d.items %}
    <tr>
        <td>{{ key }}</td>
        <td>{{ value }}</td>
    </tr>
    {% endfor %}
    </table>
    </div>

    <p>Has apostado al campe√≥n:: {{ user.team }}</p>

    <!--ul>
        <li></li>

            A correct bet gives 2 points

            Betting on the correct winner gives 1 point. For example, if you bet 2-1 and the game 3-1 gives 1 point. Or, if you bet 1-1 and the game ends 2-2 also gives 1 point

            All bets are on game result when the game ends after 90 minutes, i.e. game result before eventual game extension or penalties. 

            You can't bet on a game that has started. Clicking a started game shows all user bets

    </ul-->

    {% if latest_question_list %}
        <div style="overflow-x:auto;">
        <table>
            <tr>
                <th>Partido</th>
                <th>Resultado del partido</th>
                <th>Comienzo del partido</th>
                <th>Apuesta</th>
                <th>Puntaje de apuesta</th>
            </tr>
            {% for question in latest_question_list %}
            <tr>
            <td><a href="{% url 'polls:detail' question.id %}">{{ question.team1 }}-{{ question.team2 }}</a></td>
            <td>{{ question.score1 }}-{{ question.score2 }}</td>
            <td>
                {% if question.has_started %}
                    <strike>{{ question.playoff }}</strike>
                {% else %}
                    {{ question.playoff }}
                {% endif %}
            </td>
            {% for choice in question.choice_set.all %}
                {% if user.id == choice.user_id %}
                    <td>{{ choice.score1 }}-{{ choice.score2 }}</td>
                    <td>{{ choice.get_score }}</td>
                {% endif %}
            {% endfor %}
            </tr>
        {% endfor %}
        </table>
    </div>

    {% else %}
        <p>No polls are available.</p>
    {% endif %}

{% else %}
    <p>You are not logged in</p>
    <a href="{% url 'login' %}">login</a> |
    <a href="{% url 'signup' %}">signup</a>
{% endif %}
