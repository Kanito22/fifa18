{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'polls/style.css' %}" />

{% if user.is_authenticated %}
    <h3>Bienvenido {{ user.username }}!</h3>

    <p><a href="{% url 'logout' %}">logout</a></p>
    
    <p>Puntaje total de las apuestas: {{ number }}</p>

    <ul>
        <li>Una apuesta en el equipo ganador da 1 punto. Por ejemplo, si apuestas 2-1 y el juego termina 3-1 o si apuestas 1-1 y el juego termina 2-2</li>
        <li>Una apuesta en el resultado correcto da 2 puntos</li>
        <li>Todas las dem√°s apuestas dan 0 puntos</li>
        <li>Ni se podra apostar a un partido que ya ha comenzado</li>
    </ul>

    {% if latest_question_list %}
        <table style="width:100%">
            <th>Partido</th>
            <th>Resultado del partido</th>
            <th>Comienzo del partido</th>
            <th>Apuesta</th>
            <th>Puntaje de apuesta</th>
        {% for question in latest_question_list %}
            <tr>
            <td><a href="{% url 'polls:detail' question.id %}">{{ question.team1 }}-{{ question.team2 }}</a></td>
            <td>{{ question.score1 }}-{{ question.score2 }}</td>
            <td>
                {% if question.has_started %}
                    <strike>{{ question.playoff }}</strike>
                {% else %}
                    {{ question.playoff }}
                {% endif %}
            </td>
            {% for choice in question.choice_set.all %}
                {% if user.id == choice.user_id %}
                    <td>{{ choice.score1 }}-{{ choice.score2 }}</td>
                    <td>{{ choice.get_score }}</td>
                {% endif %}
            {% endfor %}
            </tr>
        {% endfor %}

    {% else %}
        <p>No polls are available.</p>
    {% endif %}

{% else %}
    <p>You are not logged in</p>
    <a href="{% url 'login' %}">login</a> |
    <a href="{% url 'signup' %}">signup</a>
{% endif %}
